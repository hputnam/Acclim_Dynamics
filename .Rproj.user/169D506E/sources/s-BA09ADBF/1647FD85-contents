rm(list=ls()) #clears workspace
setwd("~/MyProjects/Holobiont_Integration/RAnalysis/Data/")

# FLOW CALCULATIONS
FlowData<-read.csv('Flow_rate.csv', header=T, sep=",")
col6 = 6; #desired column
FlowRate = FlowData[,c(col6)] #isolating desired column
AVG.Flow <- mean(FlowRate)
SD.Flow <- sd(FlowRate, na.rm = FALSE)
SEM.Flow <- sd(FlowRate)/sqrt(length(FlowRate))
N.Flow <- length(FlowRate)

# TURNOVER RATE in minutes
Turnover.Rate <- ((510000/AVG.Flow)/60)

# TEMPERATURE CALCULATIONS
Daily<-read.csv('Daily_Temp_pH_Sal.csv', header=T, sep=",")
Heated.Temp <- subset(Daily, Period1=="Treatment" &Treatment =="HTAC")
# Treatment.Temp <- subset(Daily, Period1="Treatment")
# Heated.Temp <- subset(Treatment.Temp, Treatment="HTAC")
col8 = 8; #desired column
Heated.Temp = Daily[,c(col8)] #isolating desired column
na.omit(Heated.Temp)
AVG.Temp <- mean(Heated.Temp)
SD.Temp <- sd(Heated.Temp, na.rm = FALSE)
SEM.Temp <- sd(Heated.Temp)/sqrt(length(Heated.Temp))
N.Temp <- length(Heated.Temp)

Heated.Temp #20190102 ES stuck on getting daily measurements spreadsheet subsetted to HTAC and HTHC

# TOTAL ALKALINITY: Change the treatment subset to calculate average TA
TotalAlkalinity<-read.csv('Methods_Cumulative_TA_Output.csv', header=T, sep=",")
Treatment <- subset(TotalAlkalinity, Treatment=="ATHC")
col2 = 2; #desired column
TA = Treatment[,c(col2)]
AVG.TA <- mean(TA)
SD.TA <- sd(TA, na.rm = FALSE)
SEM.TA <- sd(TA)/sqrt(length(TA))
N.TA <- length(TA)

# 6 Point light calculation
Light_Data <- read.csv('BlueTank_Light_Data.csv', header=T, sep=",")
Six_Point <- subset(Light_Data, Measure_Type=="Six-point")
boxplot(PAR~Position,data=Six_Point,main="Six-Point Light Data",
        xlab="Position Number", ylab="PAR")
# One Way Anova (Completely Randomized Design)
fit <- aov(PAR ~ Position, data=Six_Point)
summary(fit) # anova uses f-statistic, which compares the variation among sample means to the variation within groups 
# OR can use:
oneway.test(PAR~Position, data=Six_Point)

# PI Curve Light Values 
PI_Curve <- read.csv('PI_Curve_Data/Methods_PICurve.csv', header=T, sep=",")
HundredP <- subset(PI_Curve, Percent=="100%")
Mean.PAR <- mean(HundredP$PAR)
Mean.PAR*0.70
Mean.PAR*0.55
Mean.PAR*0.30
Mean.PAR*0.18
Mean.PAR*0.12
Mean.PAR*0.08
Mean.PAR*0.04
Mean.PAR*0.02

Methods.Calculations <- matrix(1:9, nrow = 4, dimnames = list(c("Flow","Temperature","pH","Salinity"), c("Average","SEM","N")))
Methods.Calculations

# AVERAGE LIGHT PER PHYSIOLOGY RUN
LightRuns <- read.csv('Methods_LightRuns.csv', header=T, sep=",")
mean(LightRuns$PAR) #mean
sd(LightRuns$PAR)/sqrt(length(LightRuns$PAR)) #SEM


# Recovery tank conditions 
Recovery_conditions <- subset(Daily, Period1=="Recovery")
ggplot(Recovery_conditions, aes(x=))


